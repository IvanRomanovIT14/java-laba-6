# java-laba-6

Лабораторную работу выполнил Романов Иван ИТ-14

## Описание проекта
Проект демонстрирует работу с аннотациями Java и Reflection API. Реализует систему пользовательских аннотаций с обработчиками для автоматического выполнения методов, управления строковым представлением объектов, указания типов по умолчанию и других задач.

## Структура проекта

**Основные классы:**
- Главный класс `Main` - система меню для демонстрации всех заданий
- Утилитарные классы для валидации и обработки данных
- Специализированные классы для каждой аннотации

---

## Задание 1: Аннотация @Invoke

### Аннотация 1: Invoke
Определяет методы для автоматического вызова

**Характеристики:**
- Цель: METHOD
- Доступ: RUNTIME
- Свойства: нет

### Класс 1: InvokeProcessor
Обработчик аннотации @Invoke

**Методы:**
- `processInvokeAnnotations(Object obj)` - находит и вызывает все методы с аннотацией @Invoke используя Reflection API

### Класс 2: InvokeDemo
Демонстрационный класс с методами, помеченными аннотацией

**Свойства:**
- `method1Count` (private int) - счетчик вызовов method1
- `method2Count` (private int) - счетчик вызовов method2  
- `method3Count` (private int) - счетчик вызовов method3

**Методы:**
- `method1()` - метод с аннотацией @Invoke, увеличивает счетчик и выводит сообщение
- `method2()` - обычный метод без аннотации, увеличивает счетчик и выводит сообщение
- `method3()` - метод с аннотацией @Invoke, увеличивает счетчик и выводит сообщение
- `method4()` - метод с аннотацией @Invoke, выводит сообщение о вызове
- `isMethod1Called()` - возвращает true если method1 был вызван хотя бы раз
- `isMethod2Called()` - возвращает true если method2 был вызван хотя бы раз
- `isMethod3Called()` - возвращает true если method3 был вызван хотя бы раз
- `toString()` - возвращает строковое представление с счетчиками вызовов

**Тестирование:**

Автоматический вызов методов с аннотацией @ru.Romanov.Invoke.Invoke:

  Метод method1() вызван (вызов №1)

Автоматически вызван метод: method1

  Метод method3() вызван (вызов №1)

Автоматически вызван метод: method3

  Метод method4() с аннотацией @Invoke

Автоматически вызван метод: method4


---

## Задание 2: Аннотация @Default

### Аннотация 1: Default
Указывает тип по умолчанию для классов и полей

**Характеристики:**
- Цель: TYPE, FIELD
- Доступ: RUNTIME
- Свойства: value (Class) - обязательный

**Методы:**
- `value()` - возвращает класс типа по умолчанию

### Класс 1: DefaultProcessor
Обработчик аннотации @Default

**Методы:**
- `processDefaultAnnotations(Class<?> clazz)` - обрабатывает класс и выводит информацию о типах по умолчанию для класса и его полей

### Класс 2: DefaultDemo
Демонстрационный класс с аннотациями на классе и полях

**Свойства:**
- `field1` (private Object) - поле с типом по умолчанию Integer
- `field2` (private Object) - поле с типом по умолчанию Double
- `name` (private String) - обычное поле
- `field3` (private Object) - поле с типом по умолчанию Boolean

**Методы:**
- `DefaultDemo()` - конструктор инициализирует поля тестовыми значениями
- `getName()` - возвращает имя объекта
- `getField1()` - возвращает значение field1
- `getField2()` - возвращает значение field2
- `getField3()` - возвращает значение field3

**Аннотации:**
- `@Default(String.class)` - на классе
- `@Default(Integer.class)` - на поле field1
- `@Default(Double.class)` - на поле field2
- `@Default(Boolean.class)` - на поле field3

**Тестирование:**

Класс DefaultDemo имеет тип по умолчанию: java.lang.String

Поле field1 имеет тип по умолчанию: java.lang.Integer

Поле field2 имеет тип по умолчанию: java.lang.Double

Поле field3 имеет тип по умолчанию: java.lang.Boolean


---

## Задание 3: Аннотация @ToString

### Аннотация 1: ToString
Управляет строковым представлением объектов

**Характеристики:**
- Цель: TYPE, FIELD
- Доступ: RUNTIME
- Свойства: value (Mode) - необязательный, по умолчанию YES

**Методы:**
- `value()` - возвращает режим отображения поля

**Перечисление:**
- `Mode.YES` - включить поле в строковое представление
- `Mode.NO` - исключить поле из строкового представления

### Класс 1: ToStringProcessor
Обработчик аннотации @ToString

**Методы:**
- `toString(Object obj)` - формирует строковое представление объекта с учетом аннотации @ToString
- `shouldIncludeField(Field field, Class<?> clazz)` - определяет, должно ли поле быть включено в строковое представление на основе аннотаций

### Класс 2: ToStringDemo
Демонстрационный класс с различными настройками аннотации

**Свойства:**
- `name` (private String) - поле будет включено (по умолчанию)
- `value` (private int) - поле будет включено (по умолчанию)
- `excludedField` (private String) - поле исключено @ToString(Mode.NO)
- `includedField` (private String) - поле включено (по умолчанию)

**Методы:**
- `ToStringDemo(String name, int value, double unused)` - конструктор инициализирует поля
- `getName()` - возвращает имя объекта
- `getValue()` - возвращает числовое значение

**Аннотации:**
- `@ToString` - на классе
- `@ToString(value = ToString.Mode.NO)` - на поле excludedField

**Тестирование:**

Строковое представление: ToStringDemo{name=TestObject, value=123, includedField=Included}

Поле excludedField с @ru.Romanov.ToString.ToString(Mode.NO) исключено из вывода


---

## Задание 4: Аннотация @Validate

### Аннотация 1: Validate
Указывает классы для проверки

**Характеристики:**
- Цель: TYPE, ANNOTATION_TYPE
- Доступ: RUNTIME
- Свойства: value (Class[]) - обязательный

**Методы:**
- `value()` - возвращает массив классов для валидации

### Класс 1: ValidateProcessor
Обработчик аннотации @Validate

**Методы:**
- `processValidateAnnotations(Class<?> clazz)` - обрабатывает класс и выводит список классов для проверки, указанных в аннотации @Validate

### Класс 2: ValidateDemo
Демонстрационный класс с массивом классов для валидации

**Свойства:**
- `data` (private String) - строковые данные
- `number` (private int) - числовое значение
- `value` (private double) - значение с плавающей точкой
- `flag` (private boolean) - булево значение

**Методы:**
- `ValidateDemo()` - конструктор инициализирует поля тестовыми значениями
- `getData()` - возвращает строковые данные
- `getNumber()` - возвращает целое число
- `getValue()` - возвращает число double
- `isFlag()` - возвращает булево значение

**Аннотации:**
- `@Validate({String.class, Integer.class, Double.class, Boolean.class})` - на классе

**Тестирование:**

Классы для проверки в ValidateDemo:

  - java.lang.String

  - java.lang.Integer

  - java.lang.Double

  - java.lang.Boolean


---

## Задание 5: Аннотация @Two

### Аннотация 1: Two
Аннотация с двумя обязательными свойствами

**Характеристики:**
- Цель: TYPE
- Доступ: RUNTIME
- Свойства: first (String) - обязательный, second (int) - обязательный

**Методы:**
- `first()` - возвращает строковое значение
- `second()` - возвращает целое число

### Класс 1: TwoProcessor
Обработчик аннотации @Two

**Методы:**
- `processTwoAnnotations(Class<?> clazz)` - обрабатывает класс и выводит значения свойств аннотации @Two с проверкой корректности

### Класс 2: TwoDemo
Демонстрационный класс с двумя свойствами

**Свойства:**
- `message` (private String) - сообщение объекта
- `value` (private int) - числовое значение

**Методы:**
- `TwoDemo()` - конструктор инициализирует поля значениями по умолчанию
- `getMessage()` - возвращает строковое сообщение
- `getValue()` - возвращает целое число
- `setMessage(String message)` - устанавливает новое сообщение с проверкой на пустоту

**Аннотации:**
- `@Two(first = "Пример строки", second = 42)` - на классе

**Тестирование:**

Аннотация @Two:

  first: Пример строки

  second: 42


---

## Задание 6: Аннотация @Cache

### Аннотация 1: Cache
Указывает кешируемые области

**Характеристики:**
- Цель: TYPE
- Доступ: RUNTIME
- Свойства: value (String[]) - необязательный, по умолчанию {}

**Методы:**
- `value()` - возвращает массив строк с названиями областей кеширования

### Класс 1: CacheProcessor
Обработчик аннотации @Cache

**Методы:**
- `processCacheAnnotations(Class<?> clazz)` - обрабатывает класс и выводит список кешируемых областей
- `createMockCache(Class<?> clazz)` - создает мок-объект кеша на основе аннотации @Cache

### Класс 2: CacheDemo
Демонстрационный класс с областями кеширования

**Свойства:**
- `data` (private String) - данные объекта
- `cacheSize` (private int) - размер кеша
- `enabled` (private boolean) - статус кеша

**Методы:**
- `CacheDemo()` - конструктор инициализирует поля значениями по умолчанию
- `getData()` - возвращает строковые данные
- `getCacheSize()` - возвращает размер кеша
- `isEnabled()` - возвращает true если кеш включен
- `setData(String data)` - устанавливает новые данные с проверкой на пустоту
- `displayCacheInfo()` - выводит информацию о кеше

**Вложенный класс:**
- `EmptyCacheDemo` - класс с пустым кешем
  - `EmptyCacheDemo()` - конструктор
  - `getName()` - возвращает имя объекта

**Аннотации:**
- `@Cache({"users", "orders", "products", "settings", "cache"})` - на основном классе
- `@Cache()` - на вложенном классе (пустой массив)

**Тестирование:**

Кешируемые области для CacheDemo:

  - users

  - orders

  - products

  - settings

  - cache


---

## Задание 7: Тестирование @Default

### Класс 1: DefaultTest
JUnit тесты для аннотации @Default

**Тестовые классы:**
- `TestClassWithStringDefault` - класс с типом по умолчанию String
- `TestClassWithIntegerDefault` - класс с типом по умолчанию Integer
- `TestClassWithDoubleDefault` - класс с типом по умолчанию Double и аннотацией на поле

**Методы:**
- `testDefaultAnnotationValueMatchesExpectedClass()` - проверяет, что значение свойства value совпадает с ожидаемым классом
- `testReflectionReturnsAnnotationInstance()` - убеждается, что Reflection корректно возвращает экземпляр аннотации на классе и поле
- `testParameterizedDefaultAnnotations(Class<?> testClass, Class<?> expectedDefaultType)` - параметризованный тест для проверки нескольких классов с разными типами по умолчанию
- `defaultClassesProvider()` - поставщик данных для параметризованного теста, возвращает поток аргументов для тестирования

**Тестирование:**

Класс DefaultDemo имеет тип по умолчанию: java.lang.String

Поле field1 имеет тип по умолчанию: java.lang.Integer

Поле field2 имеет тип по умолчанию: java.lang.Double

Поле field3 имеет тип по умолчанию: java.lang.Boolean


---

## Задание 8: Тестирование @Cache

### Класс 1: CacheTest
JUnit тесты для аннотации @Cache

**Тестовые классы:**
- `TestClassWithMultipleCacheAreas` - класс с несколькими областями кеширования
- `TestClassWithEmptyCache` - класс с пустым массивом областей
- `TestClassWithSingleCacheArea` - класс с одной областью кеширования

**Методы:**
- `setUp()` - подготовка тестового окружения перед каждым тестом, инициализирует мок-кеш
- `testCacheAnnotationValuesAreCorrectlyRead()` - проверяет, что список кешируемых сущностей корректно считывается
- `testMockCacheAccessSimulation()` - мок-тест имитирует обращение к кешу с использованием встроенных подстановок
- `testNoCachingWithEmptyArray()` - проверяет, что если массив пуст – кеширование не производится
- `testMultipleNamedCacheAreas()` - отдельный тест для случая, когда кеш содержит несколько именованных областей
- `testSingleCacheArea()` - дополнительный тест для одной области кеширования

**Тестирование:**

Кешируемые области для CacheDemo:

  - users

  - orders

  - products

  - settings

  - cache


---

### Класс 1: Valid
Для валидации пользовательского ввода

**Методы:**
- `getInt()` - получает и валидирует целое число от пользователя, повторяет запрос при ошибке
- `getDouble()` - получает и валидирует число с плавающей точкой от пользователя, повторяет запрос при ошибке
- `getString(String fieldName)` - получает и валидирует непустую строку от пользователя, повторяет запрос при ошибке

---

## Главная система управления

### Класс 1: Main
Точка входа в программу с интерактивным меню

**Функциональность:**
- Обработка выбора пользователя (1-8)
- Демонстрация всех 8 заданий
- Обработка исключений и валидация ввода

**Доступные задания в меню:**
1. Аннотация @Invoke - автоматический вызов методов
2. Аннотация @Default - типы по умолчанию
3. Аннотация @ToString - строковое представление
4. Аннотация @Validate - проверка классов
5. Аннотация @Two - два обязательных свойства
6. Аннотация @Cache - области кеширования
7. Тестирование @Default (JUnit)
8. Тестирование @Cache (JUnit)

---

## Особенности реализации

### 1. Использование Reflection API:
- **Динамический вызов методов** - через Method.invoke() для @Invoke
- **Анализ аннотаций** - через getAnnotation() для всех обработчиков
- **Доступ к приватным полям** - через setAccessible(true)
- **Обход полей класса** - через getDeclaredFields()

### 2. Архитектура проекта:
- **Пакетная организация** - каждая аннотация в отдельном пакете
- **Разделение ответственности** - аннотация, обработчик и демо-класс разделены

### 3. Обработка ошибок:
- **Проверка входных данных** - валидация null и корректности значений
- **Обработка исключений** - информативные сообщения об ошибках

---

---

**Оценка: 10/10 баллов**
